---
import Layout from "../layouts/Layout.astro";
import Card from "@/components/ui/card.astro";
import { LoginForm } from "@/components/profile/LoginForm";

// Redirect if already logged in
const userDid = Astro.cookies.get("user_did")?.value;
if (userDid) {
  return Astro.redirect("/profile");
}

// Show error from failed callback
const error = Astro.url.searchParams.get("error");
---

<Layout title="Sign In - Atmosphere Conference">
  <div class="flex-1 flex items-center justify-center">
    <Card class="w-full max-w-sm p-8">
      <h1 class="text-2xl font-bold text-gray-900 text-center mb-2">
        Sign In
      </h1>
      <p class="text-gray-600 text-center mb-6">
        Sign in with your AT Protocol account
      </p>

      <LoginForm client:load error={error} />

      <p class="text-center mt-6 text-sm text-gray-600">
        Don't have an AT Protocol account?{" "}
        <a
          href="https://bsky.app"
          target="_blank"
          rel="noopener"
          class="text-[#667eea] font-medium hover:underline"
        >
          Sign up
        </a>
      </p>
    </Card>
  </div>
</Layout>
